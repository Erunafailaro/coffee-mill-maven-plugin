<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!--
 | Generated by Apache Maven Doxia at Feb 13, 2013
 | Rendered using Apache Maven Fluido Skin 1.2.2
-->
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title></title>
    <link rel="stylesheet" href="./css/apache-maven-fluido.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />

      
    <script type="text/javascript" src="./js/apache-maven-fluido.min.js"></script>

          
                
        <?xml version="1.0" encoding="UTF-8"?>
<link rel="stylesheet" type="text/css" href="./css/site.css"/>
          
    <meta name="Date-Revision-yyyymmdd" content="20130213" />
    <meta http-equiv="Content-Language" content="en" />
            </head>
        <body class="topBarDisabled">
          
    
    
            
    
        
    <a href="http://github.com/nanoko-project/coffee-mill-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 100;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png"
        alt="Fork me on GitHub">
    </a>
  
                
                    
    
        <div class="container-fluid">
          <div id="banner">
        <div class="pull-left">
                                <div id="bannerLeft">
                <h2>OW2 Nanoko -  Coffee Mill Maven Plugin</h2>
                </div>
                      </div>
        <div class="pull-right">  </div>
        <div class="clear"><hr/></div>
      </div>

      <div id="breadcrumbs">
        <ul class="breadcrumb">
                
            
                  <li id="publishDate">Last Published: 2013-02-13</li>
                  <li class="divider">|</li> <li id="projectVersion">Version: 1.0.0</li>
                      
                
            
      
                            </ul>
      </div>

            <div class="row-fluid">
        <div id="leftColumn" class="span2">
          <div class="well sidebar-nav">
                
            
                                    <h3>Overview</h3>
                  <ul>
                  <li class="none">
                          <a href="index.html" title="Introduction">Introduction</a>
            </li>
                  <li class="none">
                          <a href="plugin-info.html" title="Goals">Goals</a>
            </li>
                  <li class="none">
                          <a href="quickstart.html" title="Quickstart">Quickstart</a>
            </li>
          </ul>
                        <h3>References</h3>
                  <ul>
                  <li class="none">
            <strong>JavaScript & CoffeeScript</strong>
          </li>
                  <li class="none">
                          <a href="css-and-less.html" title="Stylesheets">Stylesheets</a>
            </li>
                  <li class="none">
                          <a href="assets-optimization.html" title="Assets Optimization">Assets Optimization</a>
            </li>
                  <li class="none">
                          <a href="project-lifecycle.html" title="Lifecycle">Lifecycle</a>
            </li>
                  <li class="none">
                          <a href="watch-mode.html" title="Watch Mode">Watch Mode</a>
            </li>
                  <li class="none">
                          <a href="reporting.html" title="Reports">Reports</a>
            </li>
          </ul>
                        <h3>Project Documentation</h3>
                  <ul>
                                                                                                                                                                                                                                                                                            <li class="collapsed">
                          <a href="project-info.html" title="Project Information">Project Information</a>
                  </li>
                                                                                                                                                                                                                                      <li class="collapsed">
                          <a href="project-reports.html" title="Project Reports">Project Reports</a>
                  </li>
          </ul>
                      
            
                
          <hr class="divider" />

           <div id="poweredBy">
                   
    <script type="text/javascript" src="https://apis.google.com/js/plusone.js"></script>

    
    <div class="g-plusone" data-href="https://github.com/nanoko-project/coffee-mill-maven-plugin/coffee-mill-maven-plugin" data-size="tall" ></div>

                   <div class="clear"></div>
                            <div class="clear"></div>
                            <div class="clear"></div>
                             <a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy">
        <img class="poweredBy" alt="Built by Maven" src="./images/logos/maven-feather.png" />
      </a>
                  </div>
          </div>
        </div>
        
        <div id="bodyColumn"  class="span10" >
                                  
            <h1>Working with JavaScript and CoffeeScript</h1><div class="section"><h2>Validating JavaScript files<a name="Validating_JavaScript_files"></a></h2><p>JavaScript files from <tt>src/main/js</tt> are validated against JSLint and JSHint. This step is automatically luanch during the <i>compile</i> phase, however you can launch it using:</p>
<div class="source"><pre class="prettyprint linenums">mvn org.nanoko.coffee-mill:coffee-mill-maven-plugin:compile-javascript
</pre></div><p>Unlike for <i>main</i> sources, <i>test</i> sources from <tt>src/test/js</tt> are <b>not</b> validated.</p></div><div class="section"><h2>Compiling CoffeeScript<a name="Compiling_CoffeeScript"></a></h2><p>The plugin is able to compile CoffeeScript sources from the <tt>src/main/coffee</tt> to JavaScript. The output files are in the <tt>target/www</tt> directory.</p><p>CoffeeScript compilation is part of the <i>js</i> packaging lifecycle. However you can launch the compilation with:</p>
<div class="source"><pre class="prettyprint linenums">mvn org.nanoko.coffee-mill:coffee-mill-maven-plugin:compile-coffeescript
</pre></div><p>The plugin also support compile <i>test</i> sources with:</p>
<div class="source"><pre class="prettyprint linenums">mvn org.nanoko.coffee-mill:coffee-mill-maven-plugin:test-compile-coffeescript
</pre></div></div><div class="section"><h2>Compiling Dust Templates<a name="Compiling_Dust_Templates"></a></h2><p>The plugin is able to compile <a class="externalLink" href="http://linkedin.github.com/dustjs/">Dust templates (linkedIn version)</a> sources from the <tt>src/main/js</tt> to JavaScript. The output files are in the <tt>target/www</tt> directory. Dust templates must use the <i>.dust</i> extension.</p><p>The compilation is part of the <i>js</i> packaging lifecycle and happens automatically during JavaScript compilation (i.e. validation).</p></div><div class="section"><h2>Testing JavaScript and CoffeeScript code<a name="Testing_JavaScript_and_CoffeeScript_code"></a></h2><p>The plugin supports Jasmine tests. <a class="externalLink" href="http://pivotal.github.com/jasmine/">Jasmine</a> is a behavior-driven development framework for testing JavaScript code. It does not depend on any other JavaScript frameworks. It does not require a DOM. And it has a clean, obvious syntax so that you can easily write tests:</p>
<div class="source"><pre class="prettyprint linenums">describe(&quot;A suite&quot;, function() {
    it(&quot;contains spec with an expectation&quot;, function() {
        expect(true).toBe(true);
    });
});
</pre></div><p>Jasmine specs are placed in the <tt>src/test/js</tt> folder (they can also be in <tt>src\test\coffee</tt> if the tests are written using CoffeeScript).</p><p>During the <i>test</i> phase, all specs are executed againt your CoffeeScript and JavaScript code.</p><p>The JavaScript files are loaded in the following order:  * Maven dependencies using the <i>js</i> type are preloaded.  * JavaScript / CoffeeScript files are loaded using the order defined in the <tt>javascriptAggregation</tt> parameter. If not defined, the sources are loaded in the alphabetical order.  * The specifications are loaded</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;SyndicationService&lt;/file&gt;
            &lt;file&gt;FeedEntry&lt;/file&gt;
            &lt;file&gt;FeedReader&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div><p>Test can be run using <tt>mvn test</tt>.</p></div><div class="section"><h2>Aggregating JavaScript files<a name="Aggregating_JavaScript_files"></a></h2><p>JavaScript files and CoffeeScript files can be aggregated into one file. Dependencies can also be included too. Generally, the order is important, so has to be specified using the <tt>javascriptAggregation</tt> parameter.</p><p>Dependencies are included using their <tt>artifactId</tt>:</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;syndication-service&lt;/file&gt; &lt;!-- This is a dependency, we use the artifact id --&gt;
            &lt;file&gt;FeedReaderImpl.js&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div></div><div class="section"><h2>Minification<a name="Minification"></a></h2><p>Once aggregated, the file can be minified using either Google Closure (default) and YUI Compressor.</p><p>** Using Google Closure **</p><p>Google Closure is used by default. So <tt>mvn package</tt> produces the minified artifact. With the following configuration:</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;syndication-service&lt;/file&gt; &lt;!-- This is a dependency, we use the artifact id --&gt;
            &lt;file&gt;FeedReaderImpl.js&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div><p>You can configure the <tt>compilation level</tt> among: _SIMPLE<i>OPTIMIZATIONS</i> (default), _WHITESPACE<i>ONLY</i> and _ADVANCED<i>OPTIMIZATIONS</i>. Be aware that _ADVANCED<i>OPTIMIZATIONS</i> may modify the API.</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;syndication-service&lt;/file&gt; &lt;!-- This is a dependency, we use the artifact id --&gt;
            &lt;file&gt;FeedReaderImpl.js&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
        &lt;minifierGoogleCompilationLevel&gt;ADVANCED_OPTIMIZATIONS&lt;/minifierGoogleCompilationLevel&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div><p>** Using Yahoo Compressor **</p><p>To use Yahoo Compressor, you need to set <tt>minifier</tt> to <tt>YUI_COMPRESSOR</tt>:</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;syndication-service&lt;/file&gt; &lt;!-- This is a dependency, we use the artifact id --&gt;
            &lt;file&gt;FeedReaderImpl.js&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
        &lt;minifier&gt;YUI_COMPRESSOR&lt;/minifier&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div><p>You can configure the minification with:</p>
<ul>
  <li><tt>minifierYUIPreserveSemiColumn</tt> : to preserve the semi-column (<tt>false</tt> by default)</li>
  <li><tt>minifierYUIMunge</tt> : to enable munge (<tt>true</tt> by default)</li>
  <li><p><tt>minifierYUIDisableOptimizations</tt> : to disable the optimizations (<tt>false</tt> by default, so optimizations are enabled)</p><p>  org.nanoko.coffee-mill  coffee-mill-maven-plugin  1.0.0  true      syndication-service <!-- This is a dependency, we use the artifact id -->  FeedReaderImpl.js    YUI_COMPRESSOR  true  true  true   </p></li>
</ul></div><div class="section"><h2>Integration Tests<a name="Integration_Tests"></a></h2><p>After aggregation and minification, it is recommended to check that the resulting JavaScript file is still behaving consistently.</p><p>You can run the test on the aggregated version and/or the minified version. Integration tests (Jasmines specs) are placed in the <tt>src/integration-test/js</tt> directory. However this can be changed to re-execute the tests from <tt>src/test/js</tt>:</p>
<div class="source"><pre class="prettyprint linenums">&lt;plugin&gt;
    &lt;groupId&gt;org.nanoko.coffee-mill&lt;/groupId&gt;
    &lt;artifactId&gt;coffee-mill-maven-plugin&lt;/artifactId&gt;
    &lt;version&gt;1.0.0&lt;/version&gt;
    &lt;extensions&gt;true&lt;/extensions&gt;
    &lt;configuration&gt;
        &lt;javascriptAggregation&gt;
            &lt;file&gt;syndication-service&lt;/file&gt; &lt;!-- This is a dependency, we use the artifact id --&gt;
            &lt;file&gt;FeedReaderImpl.js&lt;/file&gt;
        &lt;/javascriptAggregation&gt;
        &lt;javaScriptIntegrationTestDir&gt;src/test/js&lt;/javaScriptIntegrationTestDir&gt;
    &lt;/configuration&gt;
&lt;/plugin&gt;
</pre></div><p>By default, it runs the integration tests on the aggregated version and on the minified version:</p>
<div class="source"><pre class="prettyprint linenums">[INFO] --- coffee-mill-maven-plugin:1.0.0-SNAPSHOT:jasmine-it-test (default-jasmine-it-test) @
syndication-service-jfeed ---
[INFO] Running integration tests on aggregated version
[INFO] Executing Jasmine Specs
[INFO]
-------------------------------------------------------
J A S M I N E   S P E C S
-------------------------------------------------------
[INFO]
Direct Binding Test Suite
should get news from lemonde.fr
should get news from Google using RSS
should get news from Google using ATOM

Results: 3 specs, 0 failures

[INFO] Running integration tests on minified version
[INFO] Executing Jasmine Specs
[INFO]
-------------------------------------------------------
J A S M I N E   S P E C S
-------------------------------------------------------
[INFO]
Direct Binding Test Suite
should get news from lemonde.fr
should get news from Google using RSS
should get news from Google using ATOM

Results: 3 specs, 0 failures
</pre></div><p>To disable one of the version set:</p>
<ul>
  <li><tt>runJasmineTestOnAggregatedVersion</tt> : set to <tt>false</tt> to disable the integration tests on the aggregated version</li>
  <li><tt>runJasmineTestOnMinifiedVersion</tt> : set to <tt>false</tt> to disable the integation tests on the minified version</li>
</ul></div>
                  </div>
            </div>
      
    <hr/>

    <footer>
            <div class="container-fluid">
              <div class="row span12">Copyright &copy;                    2012-2013
                        <a href="http://ow2.org">OW2</a>.
            All Rights Reserved.      
            
      </div>

        
        
                </div>
    </footer>
  </body>
</html>
